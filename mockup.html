
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv='cache-control' content='no-cache'>
        <meta http-equiv='expires' content='0'>
        <meta http-equiv='pragma' content='no-cache'>
		
        <script src="js/lib/json2.js" type="text/javascript"></script>
        <script src="js/lib/raphael.js" type="text/javascript"></script>
		<script src="js/lib/joint.js" type="text/javascript"></script>
        <script src="js/lib/joint.arrows.js" type="text/javascript"></script>
        <script src="js/lib/joint.dia.js" type="text/javascript"></script>
        <script src="js/lib/joint.dia.serializer.js" type="text/javascript"></script>
        <script src="js/lib/joint.dia.fsa.js" type="text/javascript"></script>
        <script src="js/lib/joint.dia.uml.js" type="text/javascript"></script>
        <script src="js/lib/joint.dia.pn.js" type="text/javascript"></script>
        <script src="js/lib/joint.dia.devs.js" type="text/javascript"></script>
        <script src="js/lib/joint.dia.cdm.js" type="text/javascript"></script>
        <script src="js/lib/joint.dia.erd.js" type="text/javascript"></script>
        <script src="js/lib/joint.dia.org.js" type="text/javascript"></script>
        <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
        <script src="http://underscorejs.org/underscore-min.js" type="text/javascript"></script>
        <script type="text/javascript" src="js/lib/prettify/prettify.js"></script>
        
        <script src="js/lib/backbone.js" type="text/javascript"></script>
        <script src="js/lib/vkbeautify.0.99.00.beta.js" type="text/javascript"></script>
        
        <script src="js/backbone/view/appView.js" type="text/javascript"></script>
        <script src="js/backbone/view/AttributeView.js" type="text/javascript"></script>
        <script src="js/backbone/view/DiagramElementView.js" type="text/javascript"></script>
        <script src="js/backbone/view/DiagramElementPropertiesView.js" type="text/javascript"></script>
        <script src="js/backbone/view/DiagramConnectionView.js" type="text/javascript"></script>
        <script src="js/backbone/collections/DiagramElementCollection.js" type="text/javascript"></script>
        <script src="js/backbone/collections/DiagramConnectionCollection.js" type="text/javascript"></script>
        <script src="js/backbone/view/CodeView.js" type="text/javascript"></script>
        <script src="js/backbone/view/XMLMoversView.js" type="text/javascript"></script>
        <script src="js/backbone/view/XMLProtocolView.js" type="text/javascript"></script>
        
        
        <script src="js/backbone/model/Attribute.js" type="text/javascript"></script>
        <script src="js/backbone/model/DiagramElement.js" type="text/javascript"></script>
        <script src="js/backbone/model/DiagramConnection.js" type="text/javascript"></script>
        <script src="js/backbone/app.js" type="text/javascript"></script>
        
        <script type="text/template" id="attribute_template">
			<input type="text" value="<%= key %>" id="attr_key"/>
		    <input type="text" value="<%= value %>" id="attr_value"/>  <button id="deleteBtn">X</button>
		</script>
		
		<script type="text/template" id="movers_template">
&lt;<%=name%><% attributes.each(function(attr) { %> <%= attr.get('key') %>='<%= attr.get('value') %>'<% }); %>/&gt;
		</script>
		<script type="text/template" id="protocols_template">
&lt;Add <%=name%>/&gt;
		</script>
        <title>Rosetta Diagrams</title>
        <style type="text/css">
          body {
            background-color: #ffffff
          }
          #world {
            background-color: white;
            margin: 0 auto 0 auto;
            width: 1000;
            height: 800px;
            border: 3px solid gray;
            border-radius: 30px;
            position:relative;
          }
          
          .rounded_border { 
            border: 3px solid gray;
            border-radius: 30px;
          }
          #title {
            position: fixed;
            left: 10px;
            top: 10px;
            color: white;
            font-size: 14px;
          }
          #description {
            position: fixed;
            left: 10px;
            top: 45px;
            color: white;
            font-size: 12px;
            width: 250px;
          }
          #source {
            position: fixed;
            left: 20px;
            top: 37px;
            color: white;
            font-size: 12px;
          }
          #menu {
			margin: 0 auto 0 auto;
          	background-color: white;
          	border: 3px solid gray;
          	width: 760px;
          	padding: 20px;
          	margin-bottom:20px;
          	border-radius: 30px;
          }
          #connectionButton {
          	position: absolute;
          	display:none;
          }
          
          .menuItem { 
          	position: absolute;
          	width:26px;
          	height:26px;
          	background-color: black;
          	display:none;
          }
          #instructionLabel {
          	text-align: center;
          	display: inline;
          }
          #mover_div { 
          	text-align: center
          }
          .DiagramElement { } 
          #container { 
          	width: 100%;
          	height: 100%;
          }
          #workspace_container { 
          	height:100%;
          	float: left;
          }
          
          #display_code { 
          	margin-top: 5%;
          	float:left;
          	margin-left: 1%;
          	position:relative;
          	height:800px;
          	width: 800px;
          }
          
          #code { 
          	display:none;
          }
        </style>
   		<link href="js/lib/prettify/prettify.css" type="text/css" rel="stylesheet" />
        <script type="text/javascript">
 /*      
 
 		
		var joints = [];
		var all = [];
		var isGoingToConnect = false;
		var timer; //timer that clears the toolbox
		var sourceNode;
		var canvas = undefined;
		
		function gup(name){
			name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
			var regexS = "[\\?&]" + name + "=([^&#]*)";
			var regex = new RegExp(regexS);
			var results = regex.exec(window.location.href);
			if (results == null)
				return "";
			else
				return results[1];
		}
		
		function init(){
			var srcs = gup("unit").split(',');
			for (var i = 0, l = srcs.length; i < l; i++){
				var sel = document.createElement("script");
				sel.type = "text/javascript";
				sel.src = srcs[i] + ".js?" + new Date;
				document.getElementById("source").href = srcs[i] + ".js";
				document.getElementsByTagName("head").item(0).appendChild(sel);
			}
		}

		function title(s) {
		document.getElementById('title').innerHTML = s;
		}

		function description(s) {
		document.getElementById('description').innerHTML = s;
		}

		function dimension(w, h) {
			var world = document.getElementById('world');
			world.style.width = w + 'px';
			world.style.height = h + 'px';
		}
		function connectNodes(node1, node2, connectionType) {
            		var j = node1.joint(node2, connectionType).register(all);
            		joints.push(j);
            	}
		
		jQuery(document).ready(function(){
			$("#add_mover").click(function(e) {
				createMover("NewMover");				
			 });	
			 
			 canvas = new Canvas(800,800);
			 
			 //init button: 
			 btn = $("#connectionButton");
			 btn.mouseenter(function(e) { clearTimeout(timer); } );
			 btn.mouseleave( function(e) { timer =  setHideToolboxTimer(); } );
			 btn.click( function() { 
			 	isGoingToConnect = true;
			 } );
			 
			 
		});
            
            function setHideToolboxTimer() {
	            return setTimeout(function() {$("#connectionButton").css("display","none")},1000);
            }
            
            function showConnectionButton(e) { 
            	btn = $("#connectionButton");
            	var world = $("#world");
            	offset = world.offset();
		element = e.srcElement;
            	x_elem = element.x.baseVal.value;
            	y_elem = element.y.baseVal.value;
            	
            	w_elem = element.width.baseVal.value;
            	h_elem = element.height.baseVal.value;
            	
            	btn.css("top",y_elem);
            	btn.css("left", offset.left + w_elem + x_elem);
           	btn.css("display","block");
            }
            
            function createMover(name) {
            	var world = $("#world");
		var offset = world.offset();
		var rel_x = world.width()/2;
		var rel_y = world.height()/2;
		var mover = new DiagramElementView(rel_x,rel_y,"NewMover",canvas);
		
		jQuery(s3.wrapper.node).mouseup( function() { 
			if ( !isGoingToConnect ) 
				return;
			connectNodes(sourceNode,s3,uml.arrow);
			isGoingToConnect = false;
		} );
		
		jQuery(s3.wrapper.node).mouseenter( function(e) { 
			showConnectionButton(e);
			clearTimeout(timer);
			if (!isGoingToConnect)
				sourceNode = s3;
		} ); 
		
		jQuery(s3.wrapper.node).mouseleave( function(e) { 
			timer =  setHideToolboxTimer();
		} );
            } */
        </script>
    </head>
    <body onload="prettyPrint()">
    	<div id="container">
    	<div id="workspace_container">
    	<div id="menu">
    		<button id="add_mover">Add Mover</button>
    		<button id="add_filter">Add Filter</button>
    		<button id="add_connection">Add Connection</button>
    		<button id="delete_element">Delete Element</button>
    	</div>
        <div id="world">
		<script type="text/javascript">
/*
			
			var s1 = uml.State.create({
			  rect: {x: 100, y: 50, width: 100, height: 60},
			  label: "state 1",
			  attrs: {
			    fill: "90-#000-green:1-#fff"
			  },
			  shadow: true,
			  actions: {
			    entry: "init()",
			    exit: "destroy()"
			  }
			});
			var s2 = uml.State.create({
			  rect: {x: 400, y: 100, width: 100, height: 60},
			  label: "state 2",
			  attrs: {
			    fill: "90-#000-green:1-#fff"
			  },
			  shadow: true,
			  actions: {
			    entry: "create()",
			    exit: "kill()",
			    inner: ["A", "foo()", "B", "bar()"]
			  }
			});

			var s3 = uml.State.create({
			  rect: {x: 250, y: 250, width: 150, height: 100},
			  label: "DockingMover",
			  attrs: {
			    fill: "90-#000-green:1-#fff"
			  },
			  shadow: true,
			  actions: {
			    inner: ["attribute 1", "value 1", "attribute 2" , "value 2"]
			  }
			});

			var s4 = uml.State.create({
			  rect: {x: 450, y: 120, width: 80, height: 50},
			  label: "sub state 3",
			  attrs: {
			    fill: "90-#000-green:1-#fff"
			  },
			  shadow: true,
			  actions: {
			    entry: "create()"
			  }
			});

			var s0 = uml.StartState.create({
			  position: {x: 50, y: 40},
			  shadow: true
			});

			var se = uml.EndState.create({
			  position: {x: 550, y: 300},
			  shadow: true
			});

			all = [s0, se, s1, s2, s3, s4];
	
			s2.scale(2);
			s2.addInner(s4);
			
			connectNodes(s0,s1,uml.arrow);
			connectNodes(s1,s2,uml.arrow);
			connectNodes(s3,s4,uml.arrow);
			connectNodes(s2,se,uml.arrow);
			connectNodes(s1,s3,uml.arrow);
*/
		</script>
        	<div id='mover_properties'>
        	<div id="mover_div">Mover name: <input type="text" id="mover_name"/></div>
        	<div>
        	    <button id="add_attribute">Add Attribute</button>
        		<ul id="attribute_list">
        		</ul>
        	</div>
        	
        	
        	</div>
        </div> <!-- world -->
		</div> <!--  workspace container -->
 
<pre id='display_code' class='prettyprint rounded_border'>

</pre>       	
<div id="code">
<pre>
&lt;ROSETTASCRIPTS&gt;

        &lt;SCOREFXNS&gt;
        &lt;/SCOREFXNS&gt;

        &lt;TASKOPERATIONS&gt;
        &lt;/TASKOPERATIONS&gt;

        &lt;FILTERS&gt;
<span id=xml_filters>
	
</span>
        &lt;/FILTERS&gt;

        &lt;MOVERS&gt;
</pre>
<span id=xml_movers>
	
</span>
<pre>
        &lt;/MOVERS&gt;

        &lt;APPLY_TO_POSE&gt;
        &lt;/APPLY_TO_POSE&gt;

        &lt;PROTOCOLS&gt;
<span id=xml_protocols>
	
</span>
        &lt;/PROTOCOLS&gt;

&lt;/ROSETTASCRIPTS&gt;
</pre>
        </div>
        
	</div> <!--container -->

    </body>
</html>

